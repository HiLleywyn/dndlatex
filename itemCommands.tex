% Custom command definitions for D&D item cards
% Requires the xparse package for \NewDocumentCommand macros

% Item type and rarity with optional attunement requirement
\NewDocumentCommand{\ItemTags}{m m m m}{%
  \ifnum#3=0
    \textbf{#1, #2 }\\[0.1ex]
  \fi
  \ifnum#3=1
    \textbf{#1, #2 (requires attunement)}\\[0.1ex]
  \fi
  \ifnum#3=2
    \textbf{#1, #2 (requires attunement by a #4)}\\[0.1ex]
  \fi
}

% Optional italicised flavor text
\NewDocumentCommand{\FlavorText}{m m}{%
  \ifnum#1=1
    {\itshape #2}\\[0.1ex]
  \fi
}

% Mechanics for charged items
\NewDocumentCommand{\ChargeMechanics}{m m m m m m m m m}{%
  \ifnum#1>1
    This item has #1 charges and regains #2d#3 + #4 expended charges daily at #5.
  \else
    This item has #1 charge and regains #2d#3 + #4 expended charges daily at #5.
  \fi
  \ifnum#6=1 #7 \fi
  \ifnum#8=1 #9 \fi\\[0.25ex]
}

% Block describing spells granted by the item
\NewDocumentCommand{\SpellCasting}{m m m m m m}{%
  \ifnum#1=1
    \textbf{Spells. }
    \ifnum#2>0
      You gain a +#2 bonus to your spell #3
    \fi
    #5
    \ifnum#4=1 #6 \fi\\[0.25ex]
  \fi
}
% Optional curse text
\NewDocumentCommand{\CurseText}{m m}{%
  \ifnum#1=1
    \textbf{Curse.} #2\\[0.25ex]
  \fi
}

% Generic bonus paragraph
\NewDocumentCommand{\BonusText}{m m m}{%
  \ifnum#1=1
    \textbf{#2.} #3\\[0.1ex]
  \fi
}

% Weapon statistics table
\NewDocumentCommand{\WeaponStatBlock}{m m m}{%
  \begin{center}
    \begin{tabular}{ccc}
      \textbf{Damage} & \textbf{Weight} & \textbf{Properties}\\
      #1 & #2 & #3
    \end{tabular}
  \end{center}
  % Reduced extra space below table
  \vspace{0.25ex}
}

% Armor statistics table
\NewDocumentCommand{\ArmorStatBlock}{m m m m}{%
  \begin{center}
    \begin{tabular}{cccc}
      \textbf{AC} & \textbf{Strength} & \textbf{Stealth} & \textbf{Weight}\\
      #1 & #2 & #3 & #4
    \end{tabular}
  \end{center}
  % Reduced extra space below table
  \vspace{0.25ex}
}

% Simplified creature or NPC stat block
\NewDocumentCommand{\CreatureStats}{m m m m m m m m m m}{%
  \begin{center}
    \begin{tabular}{cccc}
      \textbf{AC} & \textbf{HP} & \textbf{Speed} & \textbf{CR}\\
      #1 & #2 & #3 & #10
    \end{tabular}\\[1ex]
    \begin{tabular}{cccccc}
      \textbf{STR} & \textbf{DEX} & \textbf{CON} & \textbf{INT} & \textbf{WIS} & \textbf{CHA}\\
      #4 & #5 & #6 & #7 & #8 & #9
    \end{tabular}
  \end{center}
  \vspace{0.25ex}
}

% Schools are:
%Abjuration, Conjuration, Divination, Enchantment, Evocation, Illusion, Necromancy, Transmutation
\newcommand{\SpellCardText}[8]{% #1=Spell name, #2=level[10 to turn off], #3=school, #4=casting time, #5=Range, #6=duration, #7={1-concentration, 0-not}, #8=Components
  \textbf{#1} \hfill
  \ifnum#2<10
  {\itshape
    \ifnum#2=0
      #3 Cantrip\\
    \else
        \ifnum#2=1
        1\textsuperscript{st}
        \fi
        \ifnum#2=2
        2\textsuperscript{nd}
        \fi
        \ifnum#2=3
        3\textsuperscript{rd}
        \fi
        \ifnum#2>3
        #2\textsuperscript{th}
        \fi
        level #3\\
    \fi
  \fi}
  \textbf{Casting Time: }#4 \hfill \textbf{Range: }#5\\
  \textbf{Duration: } {\ifnum#7=1  Concentration,  \fi} #6\\
  \textbf{Components: } {#8}\\[2ex]
}

% Generic property table for uniform formatting across cards
\NewDocumentCommand{\CardPropertyBlock}{O{--} O{--} O{--} O{--} O{--}}{% attack, defense, school, duration, ac
  \begin{center}
    \begin{tabular}{@{}ll@{}}
      \ifthenelse{\equal{#1}{--} \OR \equal{#1}{}}{}{\textbf{Attack} & #1\\}
      \ifthenelse{\equal{#2}{--} \OR \equal{#2}{}}{}{\textbf{Defense} & #2\\}
      \ifthenelse{\equal{#3}{--} \OR \equal{#3}{}}{}{\textbf{Spell School} & #3\\}
      \ifthenelse{\equal{#4}{--} \OR \equal{#4}{}}{}{\textbf{Duration} & #4\\}
      \ifthenelse{\equal{#5}{--} \OR \equal{#5}{}}{}{\textbf{AC} & #5\\}
    \end{tabular}
  \end{center}
  \vspace{0.25ex}
}

% Combined helper that outputs item tags followed by the property table
\NewDocumentCommand{\ItemInfo}{m m m m O{--} O{--} O{--} O{--} O{--}}{%
  \ItemTags{#1}{#2}{#3}{#4}
  \CardPropertyBlock[#5][#6][#7][#8][#9]
}
% \begin{itemcard}{Item Name}
%     \begin{center}
%       \begin{tcolorbox}[width=\linewidth, boxrule=3.0pt, colframe=black, colback=white, boxsep=0pt, top=0pt, bottom=0pt, left=0pt, right=0pt, center={yshift=-5mm}]

%         \includegraphics[width=\linewidth]{item_pics/item.png}
%         % Replace with your image file name %

%       \end{tcolorbox}
%     \end{center}
%     \begin{lowerpart}
%         % Any where you see {___ Flag}, replacing it a {1} turns on that command.

%         % \ItemTags{Type}{Rarity}{Attunement Type}{Special Attunement Requirement}
%         % {Attunement Type} = {0}, No Attunement
%         % {Attunement Type} = {1}, Attunement
%         % {Attunement Type} = {2}, Attunement with conditions

%         % \FlavorText{Flavor Flag}{Flavor text placeholder}

%         % \ChargeMechanics{Total # of Charges}{# of Dice}{# of Sides}{Modifier}{Reset Time}{Special Recharge Flag}{Special Recharge Text}{Last Charge Effect Flag}{Last Charge Effect Text}

%         % \SpellCasting{Spellcasting Flag}{Spell Bonus}{Spell Bonus Condition}{Additional Effect Flag}{Spells List}{Additional Spell Effects}
%         % \BonusText{Bonus Flag}{Bonus Title}{Bonus Text}
%         % \CurseText{Curse Flag}{Curse Description}


%         \ItemTags{Type (subtype)}{rarity}{2}{creature}
%         \FlavorText{1}{You can do multiple cards of different sizes in one go in case you want to print them off.}
%         \CurseText{1}{It doesn't make separate PNGs for each item card.
%         It also doesn't allow for giving each card a different color scheme.}
%     \end{lowerpart}
% \end{itemcard}

% \end{document}
